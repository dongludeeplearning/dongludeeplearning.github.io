<!doctype html>
<html>
<head>
<meta charset="utf-8">
<style>
  :root{
      --bg:#0b1020;
      --panel:#0f1733;
      --panel2:#0c1430;
      --text:#e8ecff;
      --muted:#aeb7e6;
      --border:rgba(255,255,255,.10);
      --accent:#7aa2ff;
      --accent2:#8bffcf;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 16px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
  }
  body {
    background: transparent;
    background-color: var(--bg);
    color: var(--text);
    font-family: var(--sans);
    margin: 0;
    padding: 16px;
    box-sizing: border-box;
  }
  ::-webkit-scrollbar { width: 8px; height: 8px; }
  ::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); }
  ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.15); border-radius: 4px; }
  ::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.25); }
</style>
</head>
<body>
<section style="max-width:980px;margin:0 auto;">
    <div style="padding:16px;border:1px solid rgba(255,255,255,.10);border-radius:16px;background:rgba(0,0,0,.10); position: relative;">
      <button onclick="toggleLang(this)" style="position: absolute; top: 16px; right: 16px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #aeb7e6; padding: 4px 10px; border-radius: 8px; cursor: pointer; font-size: 12px;">ä¸­ / En</button>
      <div style="font-family:ui-monospace,Menlo,Consolas,monospace;color:rgba(232,236,255,.7);font-size:12px;">
        Paper Digest â€¢ CVPR 2023
      </div>
      <h1 style="margin:6px 0 0;font-size:22px;line-height:1.25;">CodeTalker: Speech-Driven 3D Facial Animation with Discrete Motion Prior</h1>
      <div style="margin-top:6px;color:rgba(232,236,255,.6);font-size:12px;line-height:1.5;">
        Jinbo Xing, Menghan Xia, Yuechen Zhang, Xiaodong Cun, Jue Wang, Tien-Tsin Wong <br>
        <span style="opacity:0.8">CUHK, Tencent AI Lab</span>
      </div>
      <div style="margin-top:12px;padding-top:12px;border-top:1px solid rgba(255,255,255,.08);color:rgba(232,236,255,.75);font-size:13px;line-height:1.6;">
        <div class="lang-en">
            <b>One-Sentence Problem:</b> How to overcome the over-smoothing problem in speech-driven 3D facial animation caused by regression-to-mean, and instead generate vivid and realistic facial motions?
        </div>
        <div class="lang-zh" style="display:none">
            <b>ä¸€å¥è¯é—®é¢˜ï¼š</b>å¦‚ä½•å…‹æœç”±å›å½’å‡å€¼æ•ˆåº”å¯¼è‡´çš„è¯­éŸ³é©±åŠ¨ 3D é¢éƒ¨åŠ¨ç”»ä¸­çš„è¿‡å¹³æ»‘é—®é¢˜ï¼Œå¹¶ç”Ÿæˆç”ŸåŠ¨é€¼çœŸçš„é¢éƒ¨åŠ¨ä½œï¼Ÿ
        </div>
      </div>
    </div>
  
    <div style="display:grid;grid-template-columns:1fr;gap:14px;margin-top:14px;">
      <div style="padding:16px;border:1px solid rgba(255,255,255,.10);border-radius:16px;background:rgba(0,0,0,.10); position: relative;">
        <button onclick="toggleLang(this)" style="position: absolute; top: 16px; right: 16px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #aeb7e6; padding: 4px 10px; border-radius: 8px; cursor: pointer; font-size: 12px;">ä¸­ / En</button>
        <h2 style="margin:0 0 8px;font-size:16px;">Contributionsï¼ˆè´¡çŒ®ï¼‰</h2>
        <ul style="margin:0;padding-left:18px;color:rgba(232,236,255,.80);line-height:1.65;">
          <li style="margin-bottom:8px;">
            <div class="lang-en"><b>Discrete Motion Prior:</b> Proposed learning a discrete codebook of facial motion priors (VQ-VAE), transforming the task from continuous regression to discrete code query.</div>
            <div class="lang-zh" style="display:none"><b>ç¦»æ•£åŠ¨ä½œå…ˆéªŒï¼š</b>æå‡ºå­¦ä¹ é¢éƒ¨åŠ¨ä½œå…ˆéªŒçš„ç¦»æ•£ç æœ¬ï¼ˆVQ-VAEï¼‰ï¼Œå°†ä»»åŠ¡ä»è¿ç»­å›å½’è½¬æ¢ä¸ºç¦»æ•£ä»£ç æŸ¥è¯¢ã€‚</div>
          </li>
          <li style="margin-bottom:8px;">
            <div class="lang-en"><b>Code Query Paradigm:</b> Reformulated speech-driven animation as predicting a sequence of discrete motion codes, reducing mapping uncertainty and over-smoothing.</div>
            <div class="lang-zh" style="display:none"><b>ä»£ç æŸ¥è¯¢èŒƒå¼ï¼š</b>å°†è¯­éŸ³é©±åŠ¨åŠ¨ç”»é‡æ–°è¡¨è¿°ä¸ºé¢„æµ‹ç¦»æ•£åŠ¨ä½œä»£ç åºåˆ—ï¼Œå‡å°‘äº†æ˜ å°„ä¸ç¡®å®šæ€§å’Œè¿‡å¹³æ»‘ã€‚</div>
          </li>
          <li>
            <div class="lang-en"><b>Vividness & Realism:</b> Achieved significantly more vivid and expressive facial animations compared to regression-based methods like FaceFormer and MeshTalk.</div>
            <div class="lang-zh" style="display:none"><b>ç”ŸåŠ¨æ€§ä¸çœŸå®æ„Ÿï¼š</b>ä¸ FaceFormer å’Œ MeshTalk ç­‰åŸºäºå›å½’çš„æ–¹æ³•ç›¸æ¯”ï¼Œå®ç°äº†æ›´åŠ ç”ŸåŠ¨å’Œå¯Œæœ‰è¡¨ç°åŠ›çš„é¢éƒ¨åŠ¨ç”»ã€‚</div>
          </li>
        </ul>
      </div>

      <div style="padding:16px;border:1px solid rgba(255,255,255,.10);border-radius:16px;background:rgba(0,0,0,.10); position: relative;">
        <h2 style="margin:0 0 8px;font-size:16px;">Intro Figureï¼ˆç¤ºä¾‹ï¼‰</h2>
        <div style="border-radius:14px; overflow:hidden;">
             <img src="Figures/codetalker_intro.png" style="width:100%; height:auto; display:block; border-radius:8px;" alt="Intro Figure" />
        </div>
      </div>
  
      <div style="padding:16px;border:1px solid rgba(255,255,255,.10);border-radius:16px;background:rgba(0,0,0,.10); position: relative;">
        <button onclick="toggleLang(this)" style="position: absolute; top: 16px; right: 16px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #aeb7e6; padding: 4px 10px; border-radius: 8px; cursor: pointer; font-size: 12px;">ä¸­ / En</button>
        <h2 style="margin:0 0 8px;font-size:16px;">Challengesï¼ˆæŒ‘æˆ˜ï¼‰</h2>
        <ul style="margin:0;padding-left:18px;color:rgba(232,236,255,.80);line-height:1.65;">
          <li style="margin-bottom:8px;">
            <div class="lang-en"><b>Over-Smoothing:</b> Traditional regression-based methods tend to output "mean" or average facial poses to minimize error, resulting in dampened, lifeless expressions.</div>
            <div class="lang-zh" style="display:none"><b>è¿‡å¹³æ»‘ï¼š</b>ä¼ ç»Ÿçš„åŸºäºå›å½’çš„æ–¹æ³•å€¾å‘äºè¾“å‡ºâ€œå¹³å‡â€é¢éƒ¨å§¿æ€ä»¥æœ€å°åŒ–è¯¯å·®ï¼Œå¯¼è‡´è¡¨æƒ…åƒµç¡¬ã€ç¼ºä¹ç”Ÿæ°”ã€‚</div>
          </li>
          <li>
            <div class="lang-en"><b>Cross-Modal Uncertainty:</b> The mapping from speech to facial motion is one-to-many and highly non-linear, making direct continuous prediction difficult and prone to artifacts.</div>
            <div class="lang-zh" style="display:none"><b>è·¨æ¨¡æ€ä¸ç¡®å®šæ€§ï¼š</b>ä»è¯­éŸ³åˆ°é¢éƒ¨åŠ¨ä½œçš„æ˜ å°„æ˜¯ä¸€å¯¹å¤šä¸”é«˜åº¦éçº¿æ€§çš„ï¼Œä½¿å¾—ç›´æ¥è¿ç»­é¢„æµ‹å˜å¾—å›°éš¾ä¸”å®¹æ˜“äº§ç”Ÿä¼ªå½±ã€‚</div>
          </li>
        </ul>
      </div>
  
      <div style="padding:16px;border:1px solid rgba(255,255,255,.10);border-radius:16px;background:rgba(0,0,0,.10); position: relative;">
        <button onclick="toggleLang(this)" style="position: absolute; top: 16px; right: 16px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #aeb7e6; padding: 4px 10px; border-radius: 8px; cursor: pointer; font-size: 12px;">ä¸­ / En</button>
        <h2 style="margin:0 0 8px;font-size:16px;">Methodï¼ˆè§£å†³æ–¹æ³•ï¼‰</h2>
        <ol style="margin:0;padding-left:18px;color:rgba(232,236,255,.80);line-height:1.65;">
          <li style="margin-bottom:8px;">
            <div class="lang-en"><b>Stage 1: Codebook Learning (VQ-VAE):</b> A Vector Quantized Variational Autoencoder (VQ-VAE) is trained on 3D facial motion data to learn a discrete codebook that encapsulates realistic facial priors.</div>
            <div class="lang-zh" style="display:none"><b>é˜¶æ®µ 1ï¼šç æœ¬å­¦ä¹  (VQ-VAE)ï¼š</b>åœ¨ 3D é¢éƒ¨åŠ¨ä½œæ•°æ®ä¸Šè®­ç»ƒçŸ¢é‡é‡åŒ–å˜åˆ†è‡ªç¼–ç å™¨ (VQ-VAE)ï¼Œä»¥å­¦ä¹ å°è£…çœŸå®é¢éƒ¨å…ˆéªŒçš„ç¦»æ•£ç æœ¬ã€‚</div>
          </li>
          <li style="margin-bottom:8px;">
            <div class="lang-en"><b>Stage 2: Code Prediction:</b> A Transformer-based autoregressive model predicts the sequence of discrete code indices from audio features (wav2vec 2.0).</div>
            <div class="lang-zh" style="display:none"><b>é˜¶æ®µ 2ï¼šä»£ç é¢„æµ‹ï¼š</b>åŸºäº Transformer çš„è‡ªå›å½’æ¨¡å‹ä»éŸ³é¢‘ç‰¹å¾ (wav2vec 2.0) é¢„æµ‹ç¦»æ•£ä»£ç ç´¢å¼•åºåˆ—ã€‚</div>
          </li>
          <li>
            <div class="lang-en"><b>Decoding:</b> The predicted code sequence is decoded by the VQ-VAE decoder to generate the final continuous 3D facial motion sequence.</div>
            <div class="lang-zh" style="display:none"><b>è§£ç ï¼š</b>é¢„æµ‹çš„ä»£ç åºåˆ—ç”± VQ-VAE è§£ç å™¨è§£ç ï¼Œä»¥ç”Ÿæˆæœ€ç»ˆçš„è¿ç»­ 3D é¢éƒ¨åŠ¨ä½œåºåˆ—ã€‚</div>
          </li>
        </ol>
      </div>
  
      <div style="padding:16px;border:1px solid rgba(255,255,255,.10);border-radius:16px;background:rgba(0,0,0,.10)">
        <h2 style="margin:0 0 8px;font-size:16px;">Overview Figureï¼ˆç¤ºæ„å›¾ï¼‰</h2>
        <div style="border:1px dashed rgba(255,255,255,.18);border-radius:14px;padding:16px;color:rgba(232,236,255,.65);line-height:1.6;">
            <img src="Figures/codetalker_overview.png" style="width:100%; height:auto; display:block; border-radius:8px;" alt="Overview Figure" />
            
            <div style="margin-top:12px; display:flex; gap:10px; justify-content:flex-end;">
                 <button onclick="openLocalPdf('2301.02379.pdf')" style="background:rgba(139,255,207,0.1); border:1px solid rgba(139,255,207,0.3); color:#8bffcf; padding:6px 12px; border-radius:8px; cursor:pointer; font-size:12px;">ğŸ“‚ Open Local PDF</button>
                 <button onclick="delLocalPdf('2301.02379.pdf')" style="background:rgba(255,100,100,0.1); border:1px solid rgba(255,100,100,0.3); color:#ff6464; padding:6px 12px; border-radius:8px; cursor:pointer; font-size:12px;">ğŸ—‘ï¸ Del Local PDF</button>
            </div>
        </div>
      </div>

      <div style="padding:16px;border:1px solid rgba(255,255,255,.10);border-radius:16px;background:rgba(0,0,0,.10); position: relative;">
        <button onclick="toggleLang(this)" style="position: absolute; top: 16px; right: 16px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #aeb7e6; padding: 4px 10px; border-radius: 8px; cursor: pointer; font-size: 12px;">ä¸­ / En</button>
        <h2 style="margin:0 0 8px;font-size:16px;">Experimentsï¼ˆå®éªŒï¼‰</h2>
        <ul style="margin:0;padding-left:18px;color:rgba(232,236,255,.80);line-height:1.65;">
          <li style="margin-bottom:12px;">
            <div class="lang-en">
                <b>Quantitative:</b> Outperformed FaceFormer and MeshTalk in Lip Vertex Error (LVE) and Frechet Inception Distance (FID), indicating better lip-sync and motion quality.
            </div>
            <div class="lang-zh" style="display:none">
                <b>å®šé‡ï¼š</b>åœ¨å”‡éƒ¨é¡¶ç‚¹è¯¯å·® (LVE) å’Œ Frechet èµ·å§‹è·ç¦» (FID) æ–¹é¢ä¼˜äº FaceFormer å’Œ MeshTalkï¼Œè¡¨æ˜å…·æœ‰æ›´å¥½çš„å£å‹åŒæ­¥å’ŒåŠ¨ä½œè´¨é‡ã€‚
            </div>
          </li>
          <li style="margin-bottom:12px;">
            <div class="lang-en">
                <b>User Study:</b> Participants significantly preferred CodeTalker results for realism and expressiveness, validating the benefits of the discrete prior.
            </div>
            <div class="lang-zh" style="display:none">
                <b>ç”¨æˆ·ç ”ç©¶ï¼š</b>å‚ä¸è€…åœ¨çœŸå®æ„Ÿå’Œè¡¨ç°åŠ›æ–¹é¢æ˜¾è‘—æ›´å–œæ¬¢ CodeTalker çš„ç»“æœï¼ŒéªŒè¯äº†ç¦»æ•£å…ˆéªŒçš„ä¼˜åŠ¿ã€‚
            </div>
          </li>
        </ul>
      </div>
  
      <div style="padding:16px;border:1px solid rgba(255,255,255,.10);border-radius:16px;background:rgba(0,0,0,.10); position: relative;">
        <button onclick="toggleLang(this)" style="position: absolute; top: 16px; right: 16px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #aeb7e6; padding: 4px 10px; border-radius: 8px; cursor: pointer; font-size: 12px;">ä¸­ / En</button>
        <h2 style="margin:0 0 8px;font-size:16px;">Discussionï¼ˆè®¨è®ºï¼‰</h2>
        <ul style="margin:0;padding-left:18px;color:rgba(232,236,255,.80);line-height:1.65;">
          <li style="margin-bottom:12px;">
            <div class="lang-en">
                <b>Discrete vs. Continuous:</b> The shift from continuous regression to discrete code prediction is pivotal. By limiting the output space to a finite set of "valid" motion codes, the model avoids generating averaged, unnatural poses, resulting in sharper and more confident facial movements.
            </div>
            <div class="lang-zh" style="display:none">
                <b>ç¦»æ•£ä¸è¿ç»­ï¼š</b>ä»è¿ç»­å›å½’åˆ°ç¦»æ•£ä»£ç é¢„æµ‹çš„è½¬å˜è‡³å…³é‡è¦ã€‚é€šè¿‡å°†è¾“å‡ºç©ºé—´é™åˆ¶ä¸ºä¸€ç»„æœ‰é™çš„â€œæœ‰æ•ˆâ€åŠ¨ä½œä»£ç ï¼Œæ¨¡å‹é¿å…äº†ç”Ÿæˆå¹³å‡ã€ä¸è‡ªç„¶çš„å§¿æ€ï¼Œä»è€Œäº§ç”Ÿæ›´æ¸…æ™°ã€æ›´è‡ªä¿¡çš„é¢éƒ¨è¿åŠ¨ã€‚
            </div>
          </li>
        </ul>
        
        <div style="margin-top:16px; padding-top:12px; border-top:1px dashed rgba(255,255,255,.15);">
             <h3 style="margin:0 0 6px; font-size:14px; color:#8bffcf;">High-Level Insights: Why it Works?</h3>
             <div class="lang-en" style="color:rgba(232,236,255,.80); font-size:13px; line-height:1.6;">
                CodeTalker works by constraining the "solution space" of facial animation. Instead of asking the model to invent a face shape from scratch (which is hard and leads to safe, blurry predictions), it asks the model to pick the best matching "puzzle piece" (code) from a pre-learned set of realistic facial parts. This classification task is easier for the network to learn confidently than regression.
             </div>
             <div class="lang-zh" style="display:none; color:rgba(232,236,255,.80); font-size:13px; line-height:1.6;">
                CodeTalker çš„å·¥ä½œåŸç†æ˜¯çº¦æŸé¢éƒ¨åŠ¨ç”»çš„â€œè§£ç©ºé—´â€ã€‚å®ƒä¸æ˜¯è¦æ±‚æ¨¡å‹ä»å¤´å¼€å§‹å‘æ˜é¢éƒ¨å½¢çŠ¶ï¼ˆè¿™å¾ˆéš¾å¹¶ä¸”å¯¼è‡´å®‰å…¨ã€æ¨¡ç³Šçš„é¢„æµ‹ï¼‰ï¼Œè€Œæ˜¯è¦æ±‚æ¨¡å‹ä»é¢„å…ˆå­¦ä¹ çš„ä¸€ç»„çœŸå®é¢éƒ¨éƒ¨ä»¶ä¸­æŒ‘é€‰æœ€ä½³åŒ¹é…çš„â€œæ‹¼å›¾å—â€ï¼ˆä»£ç ï¼‰ã€‚å¯¹äºç½‘ç»œæ¥è¯´ï¼Œè¿™ä¸ªåˆ†ç±»ä»»åŠ¡æ¯”å›å½’æ›´å®¹æ˜“è‡ªä¿¡åœ°å­¦ä¹ ã€‚
             </div>
        </div>
      </div>

      <div style="padding:16px;border:1px solid rgba(255,255,255,.10);border-radius:16px;background:rgba(0,0,0,.10); display:flex; align-items:center; gap:12px;">
        <h2 style="margin:0;font-size:16px;">Official Code:</h2>
        <a href="https://github.com/Doubiiu/CodeTalker" target="_blank" style="display:flex; align-items:center; gap:6px; color:#8bffcf; text-decoration:none; font-family:ui-monospace,monospace; font-size:13px; border:1px solid rgba(139,255,207,0.3); padding:6px 12px; border-radius:8px; background:rgba(139,255,207,0.05); transition: all 0.2s ease;">
          <svg height="16" viewBox="0 0 16 16" width="16" style="fill:currentColor"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg>
          GitHub Repo
        </a>
      </div>

      <div style="padding:16px;border:1px solid rgba(255,255,255,.10);border-radius:16px;background:rgba(0,0,0,.10); position: relative;">
        <button onclick="toggleLang(this)" style="position: absolute; top: 16px; right: 16px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #aeb7e6; padding: 4px 10px; border-radius: 8px; cursor: pointer; font-size: 12px;">ä¸­ / En</button>
        <h2 style="margin:0 0 8px;font-size:16px;">Core Code Implementationï¼ˆæ ¸å¿ƒä»£ç ï¼‰</h2>
        <div style="font-size:13px;line-height:1.6;color:rgba(232,236,255,.80);">
            <div class="lang-en">
                Conceptual discrete code prediction logic.
            </div>
            <div class="lang-zh" style="display:none">
                æ¦‚å¿µç¦»æ•£ä»£ç é¢„æµ‹é€»è¾‘ã€‚
            </div>
        </div>
        
        <div style="position:relative; margin-top:12px; background:rgba(0,0,0,.3); border:1px solid rgba(255,255,255,.1); border-radius:8px; padding:12px; overflow-x:auto;">
<pre style="margin:0; font-family:Menlo,Consolas,monospace; font-size:12px; color:#d4d4d4;">
<span style="color:#6a9955;"># Code Prediction (Autoregressive)</span>
<span style="color:#569cd6;">def</span> <span style="color:#dcdcaa;">forward</span>(self, audio, past_codes):
    <span style="color:#6a9955;"># 1. Encode Audio</span>
    audio_feat = self.audio_encoder(audio)
    
    <span style="color:#6a9955;"># 2. Predict Next Code Probabilities</span>
    <span style="color:#6a9955;"># Output shape: [Batch, Time, Codebook_Size]</span>
    logits = self.transformer(audio_feat, past_codes)
    
    <span style="color:#6a9955;"># 3. Sample / Argmax to get Discrete Code</span>
    pred_code = torch.argmax(logits, dim=-1)
    
    <span style="color:#6a9955;"># 4. Decode to 3D Mesh</span>
    mesh = self.vqvae_decoder(pred_code)
    <span style="color:#569cd6;">return</span> mesh
</pre>
        </div>
      </div>
    </div>
  </section>
  <script>
    function toggleLang(btn) {
      const container = btn.closest('div');
      const enElements = container.querySelectorAll('.lang-en');
      const zhElements = container.querySelectorAll('.lang-zh');
      
      enElements.forEach(el => {
        el.style.display = (el.style.display === 'none') ? 'block' : 'none';
      });
      
      zhElements.forEach(el => {
        el.style.display = (el.style.display === 'none') ? 'block' : 'none';
      });
    }

    function openLocalPdf(filename) {
      window.open('pdfs/' + filename, '_blank');
    }

    function delLocalPdf(filename) {
      // User will implement this themselves
      alert("Please implement the delete logic or delete the file manually: pdfs/" + filename);
    }
  </script>
</body>
</html>
