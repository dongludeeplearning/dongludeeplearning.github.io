<!doctype html>
<html>
<head>
<meta charset="utf-8">
<style>
  :root{
      --bg:#0b1020;
      --panel:#0f1733;
      --panel2:#0c1430;
      --text:#e8ecff;
      --muted:#aeb7e6;
      --border:rgba(255,255,255,.10);
      --accent:#7aa2ff;
      --accent2:#8bffcf;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 16px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
  }
  body {
    background: transparent;
    background-color: var(--bg);
    color: var(--text);
    font-family: var(--sans);
    margin: 0;
    padding: 16px;
    box-sizing: border-box;
  }
  ::-webkit-scrollbar { width: 8px; height: 8px; }
  ::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); }
  ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.15); border-radius: 4px; }
  ::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.25); }
</style>
</head>
<body>
<section style="max-width:980px;margin:0 auto;">
    <div style="padding:16px;border:1px solid rgba(255,255,255,.10);border-radius:16px;background:rgba(0,0,0,.10); position: relative;">
      <button onclick="toggleLang(this)" style="position: absolute; top: 16px; right: 16px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #aeb7e6; padding: 4px 10px; border-radius: 8px; cursor: pointer; font-size: 12px;">ä¸­ / En</button>
      <div style="font-family:ui-monospace,Menlo,Consolas,monospace;color:rgba(232,236,255,.7);font-size:12px;">
        Paper Digest â€¢ ICCV 2021
      </div>
      <h1 style="margin:6px 0 0;font-size:22px;line-height:1.25;">MeshTalk: 3D Face Animation from Speech using Cross-Modality Disentanglement</h1>
      <div style="margin-top:6px;color:rgba(232,236,255,.6);font-size:12px;line-height:1.5;">
        Alexander Richard, Michael ZollhÃ¶fer, Yandong Wen, Fernando de la Torre, Yaser Sheikh <br>
        <span style="opacity:0.8">Meta Reality Labs</span>
      </div>
      <div style="margin-top:12px;padding-top:12px;border-top:1px solid rgba(255,255,255,.08);color:rgba(232,236,255,.75);font-size:13px;line-height:1.6;">
        <div class="lang-en">
            <b>One-Sentence Problem:</b> How to generate highly realistic, full-face 3D animation from speech that accurately captures lip motion while also synthesizing plausible, audio-uncorrelated upper-face expressions (e.g., blinks, brow movements)?
        </div>
        <div class="lang-zh" style="display:none">
            <b>ä¸€å¥è¯é—®é¢˜ï¼š</b>å¦‚ä½•ä»è¯­éŸ³ç”Ÿæˆé«˜åº¦é€¼çœŸçš„å…¨è„¸ 3D åŠ¨ç”»ï¼Œæ—¢èƒ½å‡†ç¡®æ•æ‰å”‡éƒ¨è¿åŠ¨ï¼Œåˆèƒ½åˆæˆåˆç†çš„ã€ä¸éŸ³é¢‘æ— å…³çš„ä¸Šè„¸è¡¨æƒ…ï¼ˆå¦‚çœ¨çœ¼ã€çœ‰æ¯›è¿åŠ¨ï¼‰ï¼Ÿ
        </div>
      </div>
    </div>
  
    <div style="display:grid;grid-template-columns:1fr;gap:14px;margin-top:14px;">
      <div style="padding:16px;border:1px solid rgba(255,255,255,.10);border-radius:16px;background:rgba(0,0,0,.10); position: relative;">
        <button onclick="toggleLang(this)" style="position: absolute; top: 16px; right: 16px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #aeb7e6; padding: 4px 10px; border-radius: 8px; cursor: pointer; font-size: 12px;">ä¸­ / En</button>
        <h2 style="margin:0 0 8px;font-size:16px;">Contributionsï¼ˆè´¡çŒ®ï¼‰</h2>
        <ul style="margin:0;padding-left:18px;color:rgba(232,236,255,.80);line-height:1.65;">
          <li style="margin-bottom:8px;">
            <div class="lang-en"><b>Cross-Modality Disentanglement:</b> Proposed a categorical latent space that disentangles facial movements into audio-correlated (lips, jaw) and audio-uncorrelated (eyes, brows) components.</div>
            <div class="lang-zh" style="display:none"><b>è·¨æ¨¡æ€è§£è€¦ï¼š</b>æå‡ºäº†ä¸€ä¸ªåˆ†ç±»æ½œåœ¨ç©ºé—´ï¼Œå°†é¢éƒ¨è¿åŠ¨è§£è€¦ä¸ºä¸éŸ³é¢‘ç›¸å…³çš„ï¼ˆå˜´å”‡ã€ä¸‹å·´ï¼‰å’Œä¸éŸ³é¢‘æ— å…³çš„ï¼ˆçœ¼ç›ã€çœ‰æ¯›ï¼‰éƒ¨åˆ†ã€‚</div>
          </li>
          <li style="margin-bottom:8px;">
            <div class="lang-en"><b>Generic Facial Animation:</b> Developed a generalized model capable of animating any face mesh topology without relying on person-specific training.</div>
            <div class="lang-zh" style="display:none"><b>é€šç”¨é¢éƒ¨åŠ¨ç”»ï¼š</b>å¼€å‘äº†ä¸€ä¸ªé€šç”¨æ¨¡å‹ï¼Œèƒ½å¤Ÿé©±åŠ¨ä»»ä½•é¢éƒ¨ç½‘æ ¼æ‹“æ‰‘ï¼Œè€Œä¸ä¾èµ–äºç‰¹å®šäººç‰©çš„è®­ç»ƒã€‚</div>
          </li>
          <li>
            <div class="lang-en"><b>Realistic Upper-Face Motion:</b> Successfully synthesized plausible eye blinks and brow movements that are not present in the audio signal but are crucial for realism.</div>
            <div class="lang-zh" style="display:none"><b>é€¼çœŸçš„ä¸Šè„¸è¿åŠ¨ï¼š</b>æˆåŠŸåˆæˆäº†éŸ³é¢‘ä¿¡å·ä¸­ä¸å­˜åœ¨ä½†å¯¹çœŸå®æ„Ÿè‡³å…³é‡è¦çš„çœ¨çœ¼å’Œçœ‰æ¯›è¿åŠ¨ã€‚</div>
          </li>
        </ul>
      </div>

      <div style="padding:16px;border:1px solid rgba(255,255,255,.10);border-radius:16px;background:rgba(0,0,0,.10); position: relative;">
        <h2 style="margin:0 0 8px;font-size:16px;">Intro Figureï¼ˆç¤ºä¾‹ï¼‰</h2>
        <div style="border-radius:14px; overflow:hidden;">
             <img src="Figures/meshtalk_intro.png" style="width:100%; height:auto; display:block; border-radius:8px;" alt="Intro Figure" />
        </div>
      </div>
  
      <div style="padding:16px;border:1px solid rgba(255,255,255,.10);border-radius:16px;background:rgba(0,0,0,.10); position: relative;">
        <button onclick="toggleLang(this)" style="position: absolute; top: 16px; right: 16px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #aeb7e6; padding: 4px 10px; border-radius: 8px; cursor: pointer; font-size: 12px;">ä¸­ / En</button>
        <h2 style="margin:0 0 8px;font-size:16px;">Challengesï¼ˆæŒ‘æˆ˜ï¼‰</h2>
        <ul style="margin:0;padding-left:18px;color:rgba(232,236,255,.80);line-height:1.65;">
          <li style="margin-bottom:8px;">
            <div class="lang-en"><b>Uncanny Upper Face:</b> Previous methods often produced static or uncanny upper face expressions because these motions (blinking, frowning) are not strongly correlated with speech audio.</div>
            <div class="lang-zh" style="display:none"><b>ææ€–è°·æ•ˆåº”çš„ä¸Šè„¸ï¼š</b>ä»¥å¾€çš„æ–¹æ³•é€šå¸¸ç”Ÿæˆé™æ€æˆ–æ€ªå¼‚çš„ä¸Šè„¸è¡¨æƒ…ï¼Œå› ä¸ºè¿™äº›è¿åŠ¨ï¼ˆçœ¨çœ¼ã€çš±çœ‰ï¼‰ä¸è¯­éŸ³éŸ³é¢‘çš„ç›¸å…³æ€§ä¸å¼ºã€‚</div>
          </li>
          <li>
            <div class="lang-en"><b>Data Scalability:</b> Many high-quality approaches require training individual models for each specific actor, limiting scalability to generic avatars.</div>
            <div class="lang-zh" style="display:none"><b>æ•°æ®å¯æ‰©å±•æ€§ï¼š</b>è®¸å¤šé«˜è´¨é‡æ–¹æ³•éœ€è¦ä¸ºæ¯ä¸ªç‰¹å®šæ¼”å‘˜è®­ç»ƒå•ç‹¬çš„æ¨¡å‹ï¼Œé™åˆ¶äº†å…¶åœ¨é€šç”¨è™šæ‹ŸåŒ–èº«ä¸­çš„æ‰©å±•æ€§ã€‚</div>
          </li>
        </ul>
      </div>
  
      <div style="padding:16px;border:1px solid rgba(255,255,255,.10);border-radius:16px;background:rgba(0,0,0,.10); position: relative;">
        <button onclick="toggleLang(this)" style="position: absolute; top: 16px; right: 16px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #aeb7e6; padding: 4px 10px; border-radius: 8px; cursor: pointer; font-size: 12px;">ä¸­ / En</button>
        <h2 style="margin:0 0 8px;font-size:16px;">Methodï¼ˆè§£å†³æ–¹æ³•ï¼‰</h2>
        <ol style="margin:0;padding-left:18px;color:rgba(232,236,255,.80);line-height:1.65;">
          <li style="margin-bottom:8px;">
            <div class="lang-en"><b>Categorical Latent Space:</b> Uses a discrete latent space to model the manifold of valid facial expressions, which helps in robust disentanglement.</div>
            <div class="lang-zh" style="display:none"><b>åˆ†ç±»æ½œåœ¨ç©ºé—´ï¼š</b>ä½¿ç”¨ç¦»æ•£æ½œåœ¨ç©ºé—´æ¥å»ºæ¨¡æœ‰æ•ˆé¢éƒ¨è¡¨æƒ…çš„æµå½¢ï¼Œè¿™æœ‰åŠ©äºé²æ£’çš„è§£è€¦ã€‚</div>
          </li>
          <li style="margin-bottom:8px;">
            <div class="lang-en"><b>Cross-Modality Loss:</b> A novel loss function enforces that the latent space separates information that can be predicted from audio vs. information that cannot.</div>
            <div class="lang-zh" style="display:none"><b>è·¨æ¨¡æ€æŸå¤±ï¼š</b>ä¸€ç§æ–°é¢–çš„æŸå¤±å‡½æ•°å¼ºåˆ¶æ½œåœ¨ç©ºé—´åˆ†ç¦»å¯ä»¥ä»éŸ³é¢‘é¢„æµ‹çš„ä¿¡æ¯å’Œä¸èƒ½ä»éŸ³é¢‘é¢„æµ‹çš„ä¿¡æ¯ã€‚</div>
          </li>
          <li>
            <div class="lang-en"><b>Autoregressive Sampling:</b> Audio-uncorrelated motions are generated via an autoregressive model conditioned on past frames, ensuring temporal coherence.</div>
            <div class="lang-zh" style="display:none"><b>è‡ªå›å½’é‡‡æ ·ï¼š</b>ä¸éŸ³é¢‘æ— å…³çš„è¿åŠ¨æ˜¯é€šè¿‡ä»¥è¿‡å»å¸§ä¸ºæ¡ä»¶çš„è‡ªå›å½’æ¨¡å‹ç”Ÿæˆçš„ï¼Œç¡®ä¿äº†æ—¶é—´è¿è´¯æ€§ã€‚</div>
          </li>
        </ol>
      </div>
  
      <div style="padding:16px;border:1px solid rgba(255,255,255,.10);border-radius:16px;background:rgba(0,0,0,.10)">
        <h2 style="margin:0 0 8px;font-size:16px;">Overview Figureï¼ˆç¤ºæ„å›¾ï¼‰</h2>
        <div style="border:1px dashed rgba(255,255,255,.18);border-radius:14px;padding:16px;color:rgba(232,236,255,.65);line-height:1.6;">
            <img src="Figures/meshtalk_overview.png" style="width:100%; height:auto; display:block; border-radius:8px;" alt="Overview Figure" />
            
            <div style="margin-top:12px; display:flex; gap:10px; justify-content:flex-end;">
                 <button onclick="openLocalPdf('2104.08223.pdf')" style="background:rgba(139,255,207,0.1); border:1px solid rgba(139,255,207,0.3); color:#8bffcf; padding:6px 12px; border-radius:8px; cursor:pointer; font-size:12px;">ğŸ“‚ Open Local PDF</button>
                 <button onclick="delLocalPdf('2104.08223.pdf')" style="background:rgba(255,100,100,0.1); border:1px solid rgba(255,100,100,0.3); color:#ff6464; padding:6px 12px; border-radius:8px; cursor:pointer; font-size:12px;">ğŸ—‘ï¸ Del Local PDF</button>
            </div>
        </div>
      </div>

      <div style="padding:16px;border:1px solid rgba(255,255,255,.10);border-radius:16px;background:rgba(0,0,0,.10); position: relative;">
        <button onclick="toggleLang(this)" style="position: absolute; top: 16px; right: 16px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #aeb7e6; padding: 4px 10px; border-radius: 8px; cursor: pointer; font-size: 12px;">ä¸­ / En</button>
        <h2 style="margin:0 0 8px;font-size:16px;">Experimentsï¼ˆå®éªŒï¼‰</h2>
        <ul style="margin:0;padding-left:18px;color:rgba(232,236,255,.80);line-height:1.65;">
          <li style="margin-bottom:12px;">
            <div class="lang-en">
                <b>User Study:</b> MeshTalk was preferred over state-of-the-art baselines (like VOCA, FaceFormer) in >75% of comparisons for realism.
            </div>
            <div class="lang-zh" style="display:none">
                <b>ç”¨æˆ·ç ”ç©¶ï¼š</b>åœ¨è¶…è¿‡ 75% çš„çœŸå®æ„Ÿæ¯”è¾ƒä¸­ï¼ŒMeshTalk ä¼˜äºæœ€å…ˆè¿›çš„åŸºçº¿æ–¹æ³•ï¼ˆå¦‚ VOCA, FaceFormerï¼‰ã€‚
            </div>
          </li>
          <li style="margin-bottom:12px;">
            <div class="lang-en">
                <b>Quantitative Metrics:</b> Achieved lower lip vertex error (LVE) and better perceptual scores on standard datasets.
            </div>
            <div class="lang-zh" style="display:none">
                <b>å®šé‡æŒ‡æ ‡ï¼š</b>åœ¨æ ‡å‡†æ•°æ®é›†ä¸Šå®ç°äº†æ›´ä½çš„å”‡éƒ¨é¡¶ç‚¹è¯¯å·®ï¼ˆLVEï¼‰å’Œæ›´å¥½çš„æ„ŸçŸ¥è¯„åˆ†ã€‚
            </div>
          </li>
        </ul>
      </div>
  
      <div style="padding:16px;border:1px solid rgba(255,255,255,.10);border-radius:16px;background:rgba(0,0,0,.10); position: relative;">
        <button onclick="toggleLang(this)" style="position: absolute; top: 16px; right: 16px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #aeb7e6; padding: 4px 10px; border-radius: 8px; cursor: pointer; font-size: 12px;">ä¸­ / En</button>
        <h2 style="margin:0 0 8px;font-size:16px;">Discussionï¼ˆè®¨è®ºï¼‰</h2>
        <ul style="margin:0;padding-left:18px;color:rgba(232,236,255,.80);line-height:1.65;">
          <li style="margin-bottom:12px;">
            <div class="lang-en">
                <b>Disentanglement is Key:</b> The success highlights that treating speech-driven animation as purely a regression problem from audio is insufficient. Explicitly modeling the "unpredictable" parts (eyes/brows) as a separate generative process is crucial for life-like animation.
            </div>
            <div class="lang-zh" style="display:none">
                <b>è§£è€¦æ˜¯å…³é”®ï¼š</b>æˆåŠŸå‡¸æ˜¾äº†ä»…å°†è¯­éŸ³é©±åŠ¨åŠ¨ç”»è§†ä¸ºä»éŸ³é¢‘å›å½’çš„é—®é¢˜æ˜¯ä¸å¤Ÿçš„ã€‚æ˜¾å¼åœ°å°†â€œä¸å¯é¢„æµ‹â€éƒ¨åˆ†ï¼ˆçœ¼ç›/çœ‰æ¯›ï¼‰å»ºæ¨¡ä¸ºå•ç‹¬çš„ç”Ÿæˆè¿‡ç¨‹å¯¹äºé€¼çœŸçš„åŠ¨ç”»è‡³å…³é‡è¦ã€‚
            </div>
          </li>
        </ul>
        
        <div style="margin-top:16px; padding-top:12px; border-top:1px dashed rgba(255,255,255,.15);">
             <h3 style="margin:0 0 6px; font-size:14px; color:#8bffcf;">High-Level Insights: Why it Works?</h3>
             <div class="lang-en" style="color:rgba(232,236,255,.80); font-size:13px; line-height:1.6;">
                It works because it acknowledges that speech does not dictate the entire facial state. By forcing the model to split the latent space, it ensures the lips follow the audio tightly (regression) while the eyes/brows are free to "hallucinate" plausible motions (generation), solving the "dead face" problem.
             </div>
             <div class="lang-zh" style="display:none; color:rgba(232,236,255,.80); font-size:13px; line-height:1.6;">
                ä¹‹æ‰€ä»¥æœ‰æ•ˆï¼Œæ˜¯å› ä¸ºå®ƒæ‰¿è®¤è¯­éŸ³å¹¶ä¸å†³å®šæ•´ä¸ªé¢éƒ¨çŠ¶æ€ã€‚é€šè¿‡å¼ºåˆ¶æ¨¡å‹åˆ†å‰²æ½œåœ¨ç©ºé—´ï¼Œå®ƒç¡®ä¿å˜´å”‡ç´§è·ŸéŸ³é¢‘ï¼ˆå›å½’ï¼‰ï¼Œè€Œçœ¼ç›/çœ‰æ¯›å¯ä»¥è‡ªç”±â€œå¹»è§‰â€åˆç†çš„è¿åŠ¨ï¼ˆç”Ÿæˆï¼‰ï¼Œä»è€Œè§£å†³äº†â€œæ­»æ¿é¢å­”â€çš„é—®é¢˜ã€‚
             </div>
        </div>
      </div>

      <div style="padding:16px;border:1px solid rgba(255,255,255,.10);border-radius:16px;background:rgba(0,0,0,.10); display:flex; align-items:center; gap:12px;">
        <h2 style="margin:0;font-size:16px;">Official Code:</h2>
        <a href="https://github.com/facebookresearch/meshtalk" target="_blank" style="display:flex; align-items:center; gap:6px; color:#8bffcf; text-decoration:none; font-family:ui-monospace,monospace; font-size:13px; border:1px solid rgba(139,255,207,0.3); padding:6px 12px; border-radius:8px; background:rgba(139,255,207,0.05); transition: all 0.2s ease;">
          <svg height="16" viewBox="0 0 16 16" width="16" style="fill:currentColor"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg>
          GitHub Repo
        </a>
      </div>

      <div style="padding:16px;border:1px solid rgba(255,255,255,.10);border-radius:16px;background:rgba(0,0,0,.10); position: relative;">
        <button onclick="toggleLang(this)" style="position: absolute; top: 16px; right: 16px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #aeb7e6; padding: 4px 10px; border-radius: 8px; cursor: pointer; font-size: 12px;">ä¸­ / En</button>
        <h2 style="margin:0 0 8px;font-size:16px;">Core Code Implementationï¼ˆæ ¸å¿ƒä»£ç ï¼‰</h2>
        <div style="font-size:13px;line-height:1.6;color:rgba(232,236,255,.80); margin-bottom: 12px;">
            <div class="lang-en">
                <b>Note on Representation:</b> Unlike SMPL-X based methods, MeshTalk operates directly on a <b>generic face mesh topology</b> (typically the FLAME topology with 5023 vertices in experiments like VOCASET). It predicts <b>vertex displacements</b> relative to a neutral template, rather than regressing low-dimensional parametric model coefficients (e.g., shape/expression params).
            </div>
            <div class="lang-zh" style="display:none">
                <b>å…³äºè¡¨ç¤ºçš„è¯´æ˜ï¼š</b>ä¸åŸºäº SMPL-X çš„æ–¹æ³•ä¸åŒï¼ŒMeshTalk ç›´æ¥åœ¨<b>é€šç”¨é¢éƒ¨ç½‘æ ¼æ‹“æ‰‘</b>ä¸Šæ“ä½œï¼ˆåœ¨ VOCASET ç­‰å®éªŒä¸­é€šå¸¸ä½¿ç”¨ 5023 ä¸ªé¡¶ç‚¹çš„ FLAME æ‹“æ‰‘ï¼‰ã€‚å®ƒé¢„æµ‹ç›¸å¯¹äºä¸­æ€§æ¨¡æ¿çš„<b>é¡¶ç‚¹ä½ç§»</b>ï¼Œè€Œä¸æ˜¯å›å½’ä½ç»´å‚æ•°åŒ–æ¨¡å‹ç³»æ•°ï¼ˆä¾‹å¦‚å½¢çŠ¶/è¡¨æƒ…å‚æ•°ï¼‰ã€‚
            </div>
        </div>
        <div style="font-size:13px;line-height:1.6;color:rgba(232,236,255,.80);">
            <div class="lang-en">
                Conceptual latent space disentanglement logic.
            </div>
            <div class="lang-zh" style="display:none">
                æ¦‚å¿µæ½œåœ¨ç©ºé—´è§£è€¦é€»è¾‘ã€‚
            </div>
        </div>
        
        <div style="position:relative; margin-top:12px; background:rgba(0,0,0,.3); border:1px solid rgba(255,255,255,.1); border-radius:8px; padding:12px; overflow-x:auto;">
<pre style="margin:0; font-family:Menlo,Consolas,monospace; font-size:12px; color:#d4d4d4;">
<span style="color:#6a9955;"># Conceptual Disentanglement</span>
<span style="color:#569cd6;">def</span> <span style="color:#dcdcaa;">forward</span>(audio, history):
    <span style="color:#6a9955;"># 1. Predict audio-correlated latent (deterministic)</span>
    z_audio = audio_encoder(audio)
    
    <span style="color:#6a9955;"># 2. Predict audio-uncorrelated latent (probabilistic/autoregressive)</span>
    z_motion = motion_prior(history)
    
    <span style="color:#6a9955;"># 3. Combine and decode</span>
    z_combined = torch.cat([z_audio, z_motion], dim=-1)
    mesh = decoder(z_combined)
    <span style="color:#569cd6;">return</span> mesh
</pre>
        </div>
      </div>
    </div>
  </section>
  <script>
    function toggleLang(btn) {
      const container = btn.closest('div');
      const enElements = container.querySelectorAll('.lang-en');
      const zhElements = container.querySelectorAll('.lang-zh');
      
      enElements.forEach(el => {
        el.style.display = (el.style.display === 'none') ? 'block' : 'none';
      });
      
      zhElements.forEach(el => {
        el.style.display = (el.style.display === 'none') ? 'block' : 'none';
      });
    }

    function openLocalPdf(filename) {
      window.open('pdfs/' + filename, '_blank');
    }

    function delLocalPdf(filename) {
      // User will implement this themselves
      alert("Please implement the delete logic or delete the file manually: pdfs/" + filename);
    }
  </script>
</body>
</html>
